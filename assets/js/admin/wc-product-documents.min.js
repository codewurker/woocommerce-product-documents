"use strict";jQuery(function(o){function e(){o(".wc-product-documents-sections .wc-product-documents-section").each(function(t,c){o(".product-documents-section-position",c).val(parseInt(o(c).index(".wc-product-documents-sections .wc-product-documents-section"),10))})}function n(){var t=o("input:radio[name=product_documents_default_section]");!1===t.is(":checked")&&t.filter("[value=0]").prop("checked",!0)}function s(t){o(".wc-product-documents .wc-product-document",t).each(function(t,c){o(".wc-product-document-position",c).val(parseInt(o(c).index(".wc-product-documents .wc-product-document"),10))})}var c,u;function d(){o("#wc-product-documents-data .wc-product-documents-set-file").on("click",function(t){t.preventDefault(),u=o(t.target).closest("tr"),c||(c=wp.media.frames.file_frame=wp.media({title:wc_product_documents_admin_params.select_file_text,button:{text:wc_product_documents_admin_params.set_file_text},multiple:!1})).on("select",function(){var t=c.state().get("selection").first().toJSON();o("input.wc-product-document-file-location",u).val(t.url)}),c.open()})}o("#wc-product-documents-data .wc-metaboxes-wrapper").on("click",".expand_all",function(){return o(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .wc-metabox-content").show(),!1}).on("click",".close_all",function(){return o(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .wc-metabox-content").hide(),!1}),o("#wc-product-documents-data").on("click",".add-new-product-documents-section",function(){var c=-1,t=(o(".wc-product-documents-sections .wc-product-documents-section .product-documents-section-index").each(function(){var t=parseInt(o(this).val(),10);c=c<t?t:c}),c++,wc_product_documents_admin_params.new_section.replace(/{index}/g,c));return o(".wc-product-documents-sections").append(t),e(),n(),!1}).on("click",".remove-wc-product-documents-section",function(){var t;return confirm(wc_product_documents_admin_params.confirm_remove_section_text)&&(t=o(this).closest(".wc-product-documents-section"),o(t).remove(),e(),n()),!1}),o(".wc-product-documents-sections").sortable({items:".wc-product-documents-section",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,helper:function(t,c){return c},start:function(t,c){c.item.css("border-style","dashed")},stop:function(t,c){c.item.removeAttr("style"),e()}}),o("#wc-product-documents-data").on("click",".wc-product-documents-add-document",function(){var t=o(this).closest(".wc-product-documents-section"),c=o(".product-documents-section-index",t).val(),e=-1,c=(o(".wc-product-document .wc-product-document-sub-index",t).each(function(){var t=parseInt(o(this).val(),10);e=e<t?t:e}),e++,wc_product_documents_admin_params.new_document.replace(/{index}/g,c).replace(/{sub_index}/g,e));return o(this).closest(".wc-product-documents").append(c),s(t),d(),!1}).on("click",".wc-product-documents-remove-document",function(){var t;return confirm(wc_product_documents_admin_params.confirm_remove_document_text)&&(t=o(this).closest(".wc-product-documents-section"),o(this).closest(".wc-product-document").remove(),s(t)),!1}),o("table.wc-product-documents tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td",scrollSensitivity:40,helper:function(t,c){return c},start:function(t,c){c.item.css("background-color","#f6f6f6")},stop:function(t,c){c.item.removeAttr("style"),s()}}),d()});